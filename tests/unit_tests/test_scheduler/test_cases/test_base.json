
{
    "change_slots": {
        "nodes":[
            [
                {
                    "uid"  : "1",
                    "cores": [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "lfs"  : { "size": 100, "path": "test" },
                    "mem"  : 1024
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "gpus" : [ 0, 0, 0 ],
                    "lfs"  : { "size": 100, "path": "test" },
                    "mem"  : 1024
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "gpus" : [ 0, 0, 0 ],
                    "lfs"  : { "size": 100, "path": "test" },
                    "mem"  : 1024
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "gpus" : [ 0, 1, 0 ],
                    "lfs"  : { "path": "test", "size": 100 },
                    "mem"  : 1014
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "gpus" : [ 0, 0, 0 ],
                    "lfs"  : { "size": 100, "path": "test" },
                    "mem"  : 1024
                }
            ]
        ],
        "slots":[
            {
                "lm_info"       : "INFO",
                "cores_per_node": 16,
                "gpus_per_node" : 6,
                "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                "ranks": [
                    {
                        "node"    : "a",
                        "node_id" : "1",
                        "core_map": [ [ 0 ] ],
                        "gpu_map" : [ ],
                        "lfs"     : { "path": "/dev/null", "size": 0 },
                        "mem"     : null
                    }
                ]
            },
            {
                "lm_info"       : "INFO",
                "cores_per_node": 16,
                "gpus_per_node" : 6,
                "lfs_per_node"  : { "size" : 0, "path" : "/dev/null" },
                "ranks"         : [
                    {
                        "node"    : "a",
                        "node_id" : "2",
                        "core_map": [[ 0 ]],
                        "gpu_map" : [[ 1 ]],
                        "lfs"     : { "path": "/dev/null", "size": 0 },
                        "mem"     : 10
                    }
                ]
            },
            {
                "lm_info"       : "INFO",
                "cores_per_node": 16,
                "gpus_per_node" : 6,
                "lfs_per_node"  : { "size" : 0, "path" : "/dev/null" },
                "ranks"         : [
                    {
                        "node"    : "a",
                        "node_id" : "2",
                        "core_map": [ [ 0 ] ],
                        "gpu_map" : [ [ 1 ] ],
                        "lfs"     : { "path": "/dev/null", "size": 0 },
                        "mem"     : 10
                    }
                ]
            },
            {
                "lm_info"       : "INFO",
                "cores_per_node": 16,
                "gpus_per_node" : 6,
                "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                "ranks"         : [
                    {
                        "node"    : "a",
                        "node_id" : "2",
                        "core_map": [ [ 0 ] ],
                        "gpu_map" : [ [ 1 ] ],
                        "lfs"     : { "path": "/dev/null", "size": 0 },
                        "mem"     : 10
                    }
                ]
            },
            {
                "lm_info"       : "INFO",
                "cores_per_node": 16,
                "gpus_per_node" : 6,
                "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                "ranks"         : [
                    {
                        "node"    : "a",
                        "node_id" : "1",
                        "core_map": [ [ 0 ] ],
                        "gpu_map" : [ ],
                        "lfs"     : { "path": "/dev/null", "size": 0 },
                        "mem"     : null
                    }
                ]
            }
        ],
        "new_state": [
            1, 1, 1, 0, 1
        ],
        "results": [
            [
                {
                    "uid"  : "1",
                    "cores": [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "lfs"  : { "path": "test", "size": 100 },
                    "mem"  : 1024
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "lfs"  : { "path": "test", "size": 100 },
                    "gpus" : [ 0,1,0 ],
                    "mem"  : 1014
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "gpus" : [ 0,1,0 ],
                    "lfs"  : { "path": "test", "size": 100 },
                    "mem"  : 1014
                }
            ],
            [
                {
                    "uid"  : "2",
                    "cores": [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
                    "gpus" : [ 0,0,0 ],
                    "lfs"  : { "path": "test", "size": 100 },
                    "mem"  : 1024
                }
            ],
            "RuntimeError"
        ]
    },
    "try_allocation":{
        "setup": [
            {
                "task": {
                    "uid": "task.000000",
                    "description": {
                        "executable" : "/bin/sleep",
                        "environment": {
                        }
                    }
                },
                "scheduled_task_slots": {
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                    "ranks"         : [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : null,
                            "lfs"     : { "path": "/dev/null", "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            },
            {
                "task": {
                    "uid": "task.000001",
                    "description": {
                        "executable" : "/bin/sleep",
                        "environment": { }
                    }
                },
                "scheduled_task_slots": {
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": null },
                    "ranks"         : [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : null,
                            "lfs"     : { "path": null, "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            }
        ],
        "results": [
            {
                "uid": "task.000000",
                "description": {
                    "executable" : "/bin/sleep",
                    "environment": {
                        "NODE_LFS_PATH": "/dev/null"
                    }
                },
                "slots": {
                    "cores_per_node": 16,
                    "lm_info"       : "INFO",
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "path": "/dev/null", "size": 0 },
                    "ranks"         : [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : null,
                            "lfs"     : { "path": "/dev/null", "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            },
            {
                "uid": "task.000001",
                "description": {
                    "executable": "/bin/sleep",
                    "environment": { }
                },
                "slots": {
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "path": null, "size": 0 },
                    "ranks": [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : null,
                            "lfs"     : { "path": null, "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            }
        ]
    },
    "handle_cuda": {
        "setup": [
            { "rm_info":{ "lm_info":{                                } } },
            { "rm_info":{ "lm_info":{                                } } },
            { "rm_info":{ "lm_info":{ "cvd_id_mode":"physical"       } } },
            { "rm_info":{ "lm_info":{ "cvd_id_mode":"logical"        } } },
            { "rm_info":{ "lm_info":{ "cvd_id_mode":"something_else" } } }
        ],
        "task":[
            {
                "description":{
                    "environment": { }
                },
                "slots":{
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                    "ranks": [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : null,
                            "lfs"     : { "path": "/dev/null", "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            },
            {
                "description":{
                    "environment": { }
                },
                "slots":{
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                    "ranks": [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : [ [ 1 ] ],
                            "lfs"     : { "path": "/dev/null", "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            },
            {
                "description": {
                    "environment": { }
                },
                "slots":{
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                    "ranks": [
                        {
                            "node"     : "a",
                            "node_id"  : "1",
                            "core_map" : [ [ 0 ] ],
                            "gpu_map"  : [ [ 0 ],[ 1 ] ],
                            "lfs"      : { "path": "/dev/null", "size": 0 },
                            "mem"      : null
                        }
                    ]
                }
            },
            {
                "description": {
                    "environment": { }
                },
                "slots":{
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                    "ranks": [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : [ ],
                            "lfs"     : { "path": "/dev/null", "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            },
            {
                "description": {
                    "environment": { }
                },
                "slots":{
                    "lm_info"       : "INFO",
                    "cores_per_node": 16,
                    "gpus_per_node" : 6,
                    "lfs_per_node"  : { "size": 0, "path": "/dev/null" },
                    "ranks": [
                        {
                            "node"    : "a",
                            "node_id" : "1",
                            "core_map": [ [ 0 ] ],
                            "gpu_map" : [ [ 0 ] ],
                            "lfs"     : { "path": "/dev/null", "size": 0 },
                            "mem"     : null
                        }
                    ]
                }
            }
        ],
        "results": [
            "KeyError",
            "1",
            "0,1",
            "KeyError",
            "ValueError"
        ]
    }
}

